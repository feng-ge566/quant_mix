import torch

GATHER = True

LPR8B = [0, 1, 2, 3, 4, 5, 6, 7, 8, 8, 9, 9, 14, 14, 15, 15, 16, 16, 17, 17, 22, 22, 23, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 40, 41, 41, 46, 46, 47, 47, 48, 48, 49, 49, 54, 54, 55, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 64, 65, 65, 66, 66, 67, 67, 68, 68, 69, 69, 70, 70, 71, 71, 72, 72, 72, 72, 73, 73, 73, 73, 78, 78, 78, 78, 79, 79, 79, 79, 112, 112, 112, 112, 113, 113, 113, 113, 118, 118, 118, 118, 119, 119, 119, 119, 120, 120, 121, 121, 122, 122, 123, 123, 124, 124, 125, 125, 126, 126, 127, 127, -128, -128, -127, -127, -126, -126, -125, -125, -124, -124, -123, -123, -122, -122, -121, -121, -120, -120, -120, -120, -119, -119, -119, -119, -114, -114, -114, -114, -113, -113, -113, -113, -80, -80, -80, -80, -79, -79, -79, -79, -74, -74, -74, -74, -73, -73, -73, -73, -72, -72, -71, -71, -70, -70, -69, -69, -68, -68, -67, -67, -66, -66, -65, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -56, -55, -55, -50, -50, -49, -49, -48, -48, -47, -47, -42, -42, -41, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -24, -23, -23, -18, -18, -17, -17, -16, -16, -15, -15, -10, -10, -9, -9, -8, -7, -6, -5, -4, -3, -2, -1]
label_data = torch.tensor(LPR8B, dtype=torch.long)
# for v in label_data:
#     if v < 0:
#         x = 256 + v
#dim_data = torch.tensor([0, 1.6, 2, 3, 4, 5,6, 7, 8, 9.1, 10.01, 11, 12, 13,  -128, -127, -128, -121, -10, -11, -12,-13, -9, -8, -7, -6, -5, -4, -3, -2, -1], dtype=torch.long)

dim_data = torch.tensor([0, 1.6, 2, 3, 4, 5,6, 7, 8, 9.1, 10.01, 11, 12, 13,  -128, -127, -128, -121, -10, -11, -12,-13, -9, -8, -7, -6, -5, -4, -3, -2, -1])
dim_data= dim_data.round()

dim_data = dim_data.long().clone()

dim_data = torch.tensor(dim_data, dtype = torch.long)

data = torch.take(label_data,  dim_data)
print(data)

